\chapter{PNL Vincolata}

\section{Riduzione del numero di variabili libere}

Supponiamo di avere un problema di ottimizzazione soggetto ad un certo numero $n$ di vincoli di uguaglianza.

Nel caso in cui sia possibile esplicitare $n$ variabili in funzione delle restanti $m-n$ variabili utilizzando i vincoli di ugualianza del problema allora possiamo trasformare tale problema in un problema di ottimizzazione non vincolata con $m-n$ variabili

Quindi esplicito le variabili nei vincoli e le sostituisco all'interno del resto del sistema (vincoli funzionali e funzione obiettivo)

Posso esplicitare una variabile solo se facendolo puo' assumere solo un valore.

\section{Metodo dei moltiplicatori di Lagrange}

Sia un generico pnl vincolato con solo vincoli di uguaglianza:

\begin{align*}
    opt & f (x_1,...,x_n) \\
    g_i(x_1,...,x_n) &= 0
\end{align*}

Consideriamo la funzione L:

\[
    L(x_1,...,x_n,\lambda_1,...,\lambda_n) = f(x_1,...,x_n) + \Sigma ^ m _ {i=0} \lambda_i g_i(x_1,...,x_n)
\]

Tale funzione prende il nome di Lagrangiana e le variabili $\lambda_i$ sono chiamate moltiplicatori di Lagrange

Sia $x_o = (x_{1o},...,x_{no})$ il punto stazionario di f, allora esistono m moltiplicatori di Lagrange tali che, detto $\lambda_o = (\lambda_{1o},...,\lambda_{mo})$, $(x_o,\lambda_o)$ e' un punto stazionario della Lagrangiana associata.

\paragraph{Condizione di ottimalita' di primo grado}

Sia $x_o = (x_{1o},...,x_{no})$ il punto stazionario di f, allora esistono m moltiplicatori di Lagrange tali che, detto $\lambda_o = (\lambda_{1o},...,\lambda_{mo})$, nel punto $(x_o,\lambda_o)$ il gradiente della Lagrangiana associata si annulla.

\paragraph{Condizione di ottimalita' di primo grado}

Sia J la matrice dei gradienti dei vincoli (matrice Jacobiana).
Consideriamo l'insieme dei vettori $y \in \R^n$ tali che:

\[ J(x_o) \cdot y = 0 \]

Dove

\[
    J(x_o) =
    \begin{pmatrix}
        \frac {\delta g_1} {\delta x_1} && ... && \frac {\delta g_1} {\delta x_n} \\
        ... && ... && ... \\
        \frac {\delta g_m} {\delta x_1} && ... && \frac {\delta g_m} {\delta x_n}
    \end{pmatrix}
\]

Consideriamo ora la Henessiana della funzione Lagrangiana ristretta alle variabili $x_i$:

\[
    H(x_o, \lambda_o) =
    \begin{pmatrix}
        \frac {\delta^2 L} {\delta^2 x_1} && ... && \frac {\delta^2 L} {\delta x_1 x_n} \\
        ... && ... && ... \\
        \frac {\delta^2 L} {\delta x_1 x_n} && ... && \frac {\delta^2 L} {\delta^2 x_n}
    \end{pmatrix}
\]

\begin{itemize}
    \item Se $y^t \cdot H_L(x,\lambda_o) \cdot y > 0$ allora $x$ e' punto di minimo
    \item Se $y^t \cdot H_L(x,\lambda_o) \cdot y < 0$ allora $x$ e' punto di massimo
    \item Se $x$ e' un punto di minimo allora $y^t \cdot H_L(x,\lambda_o) \cdot y \geq 0$
    \item Se $x$ e' un punto di massimo allora $y^t \cdot H_L(x,\lambda_o) \cdot y \leq 0$
\end{itemize}

\section{Condizioni di Karush-Kuhn Tucker}

Queste condizioni (necessarie ma non sufficienti) generalizzano il metodo dei moltiplicatori di Lagrange ai vincoli di disuguaglianza.

Sia un generico pnl vincolato:

\begin{align*}
    opt & f (x_1,...,x_n) \\
    g_i(x_1,...,x_n) &= 0 \\
    h_j(x_1,...,x_n) &\leq 0
\end{align*}

Sia $x_o = (x_{o1},...,x_{on})$ un punto di ottimo di f, allora $h_j(x_o)$ puo' essere attivo ($h_j(x_o) = 0$) o inattivo ($h_j(x_o) < 0$).

Indico con $I(x_o)$ l'insieme degli indici dei vincoli attivi.


Sia $x_o = (x_{1o},...,x_{no})$ il punto di ottimo di f, allora esistono m moltiplicatori $\lambda_o = (\lambda_{1o},...,\lambda_{mo})$ e $u_o = (u_{o1},...,u_{op})$, tali che si verifichino le seguenti condizioni:

\paragraph{Condizioni di stazionarieta'}

\begin{align*}
    \nabla f(x_o) + \Sigma ^ m _ {i=1} \lambda_oi \nabla g_i(x_o) + \Sigma ^ p _ {j=1} u_oi \nabla h_j(x_o) = 0 && problemi di minimo \\
    \nabla f(x_o) - \Sigma ^ m _ {i=1} \lambda_oi \nabla g_i(x_o) - \Sigma ^ p _ {j=1} u_oi \nabla h_j(x_o) = 0 && problemi di massimo
\end{align*}

\paragraph{Ammissibilita' primale}

\begin{align*}
    g_i(x_o) = 0 && \forall i = 1,...,m \\
    h_j(x_o) = 0 && \forall j = 1,...,p
\end{align*}

\paragraph{Ammissibilita' duale}

\begin{align*}
    u_{oj} = 0 && \forall j = 1,...,p
\end{align*}

\paragraph{Condizioni di complementarieta'}

\begin{align*}
    u_{oj} \cdot h_j(x_o) = 0 && \forall j = 1,...,p
\end{align*}
